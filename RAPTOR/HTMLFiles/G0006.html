
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="RAPTOR.css">
    <link rel="shortcut icon" href="./images/favicon.ico" type="image/x-icon">
    <title>APT1</title>
  </head>
  <body>
    <div class="container">
      <div class="navmenu">
        <ul>
          <li><a href="index.html">Print All</a></li>
          <li><a href="about.html">About</a></li>
          <li class="left"><a href="index.html"><img src="./images/raptor.png" id="logo"></a></li>
        </ul>
      </div>
      <div class="groupmenu">
        <div>
          <h2>90+%</h2>
            <p><a href="G0130.html">Ajax Security Team</a></p>
          <h2>80% - 89%</h2>
            <p><a href="G0032.html">Lazarus Group</a></p>
          <h2>70% - 79%</h2>
            <p><a href="G0035.html">Dragonfly</a></p>
          <h2>60% - 69%</h2>
            <p><a href="G0006.html">APT1</a></p>
            <p><a href="G0080.html">Cobalt Group</a></p>
          <h2>50% - 59%</h2>
            <p><a href="G0100.html">Inception</a></p>
            <p><a href="G0125.html">HAFNIUM</a></p>
    </div>
      </div>
      <div class="groupinfo">
        <div>
          <h1>APT1</h1>
            <p>[<a href="https://attack.mitre.org/groups/G0006">APT1</a>] is a Chinese threat group that has been attributed to the 2nd Bureau of the People’s Liberation Army (PLA) General Staff Department’s (GSD) 3rd Department, commonly known by its Military Unit Cover Designator (MUCD) as Unit 61398. </p>
          <h2>Associated Groups</h2>
            <p>Comment Crew, Comment Group, Comment Panda</p>
          <button id ="button1" class="collapsible">Software</button>
            <div class="content">
              <button id="button2" class="collapsible">BISCUIT</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0017">BISCUIT</a>] is a backdoor that has been used by [<a href="https://attack.mitre.org/groups/G0006">APT1</a>] since as early as 2007. </p>
                </div>
              <button id="button2" class="collapsible">CALENDAR</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0025">CALENDAR</a>] is malware used by [<a href="https://attack.mitre.org/groups/G0006">APT1</a>] that mimics legitimate Gmail Calendar traffic. </p>
                </div>
              <button id="button2" class="collapsible">Cachedump</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0119">Cachedump</a>] is a publicly-available tool that program extracts cached password hashes from a system’s registry. </p>
                </div>
              <button id="button2" class="collapsible">GLOOXMAIL</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0026">GLOOXMAIL</a>] is malware used by [<a href="https://attack.mitre.org/groups/G0006">APT1</a>] that mimics legitimate Jabber/XMPP traffic. </p>
                </div>
              <button id="button2" class="collapsible">Lslsass</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0121">Lslsass</a>] is a publicly-available tool that can dump active logon session password hashes from the lsass process. </p>
                </div>
              <button id="button2" class="collapsible">Mimikatz</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0002">Mimikatz</a>] is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks.  </p>
                </div>
              <button id="button2" class="collapsible">Net</button>
                <div class="content">
                  <p>The [<a href="https://attack.mitre.org/software/S0039">Net</a>] utility is a component of the Windows operating system. It is used in command-line operations for control of users, groups, services, and network connections. 

[<a href="https://attack.mitre.org/software/S0039">Net</a>] has a great deal of functionality,  much of which is useful for an adversary, such as gathering system and network information for Discovery, moving laterally through [<a href="https://attack.mitre.org/techniques/T1021/002">SMB/Windows Admin Shares</a>] using <code>net use</code> commands, and interacting with services. The net1.exe utility is executed for certain functionality when net.exe is run and can be used directly in commands such as <code>net1 user</code>.</p>
                </div>
              <button id="button2" class="collapsible">Pass-The-Hash Toolkit</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0122">Pass-The-Hash Toolkit</a>] is a toolkit that allows an adversary to "pass" a password hash (without knowing the original password) to log in to systems. </p>
                </div>
              <button id="button2" class="collapsible">PoisonIvy</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0012">PoisonIvy</a>] is a popular remote access tool (RAT) that has been used by many groups.   </p>
                </div>
              <button id="button2" class="collapsible">PsExec</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0029">PsExec</a>] is a free Microsoft tool that can be used to execute a program on another computer. It is used by IT administrators and attackers.  </p>
                </div>
              <button id="button2" class="collapsible">Seasalt</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0345">Seasalt</a>] is malware that has been linked to [<a href="https://attack.mitre.org/groups/G0006">APT1</a>]'s 2010 operations. It shares some code similarities with [<a href="https://attack.mitre.org/software/S0346">OceanSalt</a>].</p>
                </div>
              <button id="button2" class="collapsible">Tasklist</button>
                <div class="content">
                  <p>The [<a href="https://attack.mitre.org/software/S0057">Tasklist</a>] utility displays a list of applications and services with their Process IDs (PID) for all tasks running on either a local or a remote computer. It is packaged with Windows operating systems and can be executed from the command-line interface. </p>
                </div>
              <button id="button2" class="collapsible">WEBC2</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0109">WEBC2</a>] is a family of backdoor malware used by [<a href="https://attack.mitre.org/groups/G0006">APT1</a>] as early as July 2006. [<a href="https://attack.mitre.org/software/S0109">WEBC2</a>] backdoors are designed to retrieve a webpage, with commands hidden in HTML comments or special tags, from a predetermined C2 server. </p>
                </div>
              <button id="button2" class="collapsible">gsecdump</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0008">gsecdump</a>] is a publicly-available credential dumper used to obtain password hashes and LSA secrets from Windows operating systems. </p>
                </div>
              <button id="button2" class="collapsible">ipconfig</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0100">ipconfig</a>] is a Windows utility that can be used to find information about a system's TCP/IP, DNS, DHCP, and adapter configuration. </p>
                </div>
              <button id="button2" class="collapsible">pwdump</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0006">pwdump</a>] is a credential dumper. </p>
                </div>
              <button id="button2" class="collapsible">xCmd</button>
                <div class="content">
                  <p>[<a href="https://attack.mitre.org/software/S0123">xCmd</a>] is an open source tool that is similar to [<a href="https://attack.mitre.org/software/S0029">PsExec</a>] and allows the user to execute applications on remote systems. </p>
                </div>
            </div>
          <button id ="button1" class="collapsible">Techniques</button>
            <div class="content">
            <button id="button2" class="collapsible">Archive Collected Data: Archive via Utility</button>
              <div class="content">
                <p>An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities. Many utilities exist that can archive data, including 7-Zip, WinRAR, and WinZip. Most utilities include functionality to encrypt and/or compress data.

Some 3rd party utilities may be preinstalled, such as `tar` on Linux and macOS or `zip` on Windows systems.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Automated Collection</button>
              <div class="content">
                <p>Once established within a system or network, an adversary may use automated techniques for collecting internal data. Methods for performing this technique could include use of a [<a href="https://attack.mitre.org/techniques/T1059">Command and Scripting Interpreter</a>] to search for and copy information fitting set criteria such as file type, location, or name at specific time intervals. This functionality could also be built into remote access tools. 

This technique may incorporate use of other techniques such as [<a href="https://attack.mitre.org/techniques/T1083">File and Directory Discovery</a>] and [<a href="https://attack.mitre.org/techniques/T1570">Lateral Tool Transfer</a>] to identify and move files.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Encrypt Sensitive Information - Protect sensitive information with strong encryption.</p>
                    <p>Remote Data Storage - Use remote security log and sensitive file storage where access can be controlled better to prevent exposure of intrusion detection log data or sensitive information.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Data from Local System</button>
              <div class="content">
                <p>Adversaries may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration.

Adversaries may do this using a [<a href="https://attack.mitre.org/techniques/T1059">Command and Scripting Interpreter</a>], such as [<a href="https://attack.mitre.org/software/S0106">cmd</a>], which has functionality to interact with the file system to gather information. Some adversaries may also use [<a href="https://attack.mitre.org/techniques/T1119">Automated Collection</a>] on the local system.
</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Data Loss Prevention - Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Acquire Infrastructure: Domains</button>
              <div class="content">
                <p>Adversaries may purchase domains that can be used during targeting. Domain names are the human readable names used to represent one or more IP addresses. They can be purchased or, in some cases, acquired for free.

Adversaries can use purchased domains for a variety of purposes, including for [<a href="https://attack.mitre.org/techniques/T1566">Phishing</a>], [<a href="https://attack.mitre.org/techniques/T1189">Drive-by Compromise</a>], and Command and Control. Adversaries may choose domains that are similar to legitimate domains, including through use of homoglyphs or use of a different top-level domain (TLD). Typosquatting may be used to aid in delivery of payloads via [<a href="https://attack.mitre.org/techniques/T1189">Drive-by Compromise</a>]. Adversaries can also use internationalized domain names (IDNs) to create visually similar lookalike domains for use in operations.

Domain registrars each maintain a publicly viewable database that displays contact information for every registered domain. Private WHOIS services display alternative information, such as their own company data, rather than the owner of the domain. Adversaries may use such private WHOIS services to obscure information about who owns a purchased domain. Adversaries may further interrupt efforts to track their infrastructure by using varied registration information and purchasing domains with different domain registrars.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Compromise Infrastructure: Domains</button>
              <div class="content">
                <p>Adversaries may hijack domains and/or subdomains that can be used during targeting. Domain registration hijacking is the act of changing the registration of a domain name without the permission of the original registrant. An adversary may gain access to an email account for the person listed as the owner of the domain. The adversary can then claim that they forgot their password in order to make changes to the domain registration. Other possibilities include social engineering a domain registration help desk to gain access to an account or taking advantage of renewal process gaps.

Subdomain hijacking can occur when organizations have DNS entries that point to non-existent or deprovisioned resources. In such cases, an adversary may take control of a subdomain to conduct operations with the benefit of the trust associated with that domain.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Establish Accounts: Email Accounts</button>
              <div class="content">
                <p>Adversaries may create email accounts that can be used during targeting. Adversaries can use accounts created with email providers to further their operations, such as leveraging them to conduct [<a href="https://attack.mitre.org/techniques/T1598">Phishing for Information</a>] or [<a href="https://attack.mitre.org/techniques/T1566">Phishing</a>]. Adversaries may also take steps to cultivate a persona around the email account, such as through use of [<a href="https://attack.mitre.org/techniques/T1585/001">Social Media Accounts</a>], to increase the chance of success of follow-on behaviors. Created email accounts can also be used in the acquisition of infrastructure (ex: [<a href="https://attack.mitre.org/techniques/T1583/001">Domains</a>]).

To decrease the chance of physically tying back operations to themselves, adversaries may make use of disposable email services.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">OS Credential Dumping: LSASS Memory</button>
              <div class="content">
                <p>Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct [<a href="https://attack.mitre.org/tactics/TA0008">Lateral Movement</a>] using [<a href="https://attack.mitre.org/techniques/T1550">Use Alternate Authentication Material</a>].

As well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.

For example, on the target host use procdump:

* <code>procdump -ma lsass.exe lsass_dump</code>

Locally, mimikatz can be run using:

* <code>sekurlsa::Minidump lsassdump.dmp</code>
* <code>sekurlsa::logonPasswords</code>

Built-in Windows tools such as comsvcs.dll can also be used:

* <code>rundll32.exe C:\Windows\System32\comsvcs.dll MiniDump PID  lsass.dmp full</code>


Windows Security Support Provider (SSP) DLLs are loaded into LSSAS process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> and <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.

The following SSPs can be used to access credentials:

* Msv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.
* Wdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges.
* Kerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.
* CredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services.
</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</p>
                    <p>Credential Access Protection - Use capabilities to prevent successful credential access by adversaries; including blocking forms of credential dumping.</p>
                    <p>Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</p>
                    <p>Password Policies - Set and enforce secure password policies for accounts.</p>
                    <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p>
                    <p>Privileged Process Integrity - Protect processes with high privileges that can be used to interact with critical system components through use of protected process light, anti-process injection defenses, or other process integrity enforcement measures.</p>
                    <p>User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Account Discovery: Local Account</button>
              <div class="content">
                <p>Adversaries may attempt to get a listing of local system accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior.

Commands such as <code>net user</code> and <code>net localgroup</code> of the [<a href="https://attack.mitre.org/software/S0039">Net</a>] utility and <code>id</code> and <code>groups</code>on macOS and Linux can list local users and groups. On Linux, local users can also be enumerated through the use of the <code>/etc/passwd</code> file. On macOS the <code>dscl . list /Users</code> command can be used to enumerate local accounts.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Email Collection: Local Email Collection</button>
              <div class="content">
                <p>Adversaries may target user email on local systems to collect sensitive information. Files containing email data can be acquired from a user’s local system, such as Outlook storage or cache files.

Outlook stores data locally in offline data files with an extension of .ost. Outlook 2010 and later supports .ost file sizes up to 50GB, while earlier versions of Outlook support up to 20GB. IMAP accounts in Outlook 2013 (and earlier) and POP accounts use Outlook Data Files (.pst) as opposed to .ost, whereas IMAP accounts in Outlook 2016 (and later) use .ost files. Both types of Outlook data files are typically stored in `C:\Users\<username>\Documents\Outlook Files` or `C:\Users\<username>\AppData\Local\Microsoft\Outlook`.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Encrypt Sensitive Information - Protect sensitive information with strong encryption.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Obtain Capabilities: Malware</button>
              <div class="content">
                <p>Adversaries may buy, steal, or download malware that can be used during targeting. Malicious software can include payloads, droppers, post-compromise tools, backdoors, packers, and C2 protocols. Adversaries may acquire malware to support their operations, obtaining a means for maintaining control of remote machines, evading defenses, and executing post-compromise behaviors.

In addition to downloading free malware from the internet, adversaries may purchase these capabilities from third-party entities. Third-party entities can include technology companies that specialize in malware development, criminal marketplaces (including Malware-as-a-Service, or MaaS), or from individuals. In addition to purchasing malware, adversaries may steal and repurpose malware from third-party entities (including other adversaries).</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Masquerading: Match Legitimate Name or Location</button>
              <div class="content">
                <p>Adversaries may match or approximate the name or location of legitimate files or resources when naming/placing them. This is done for the sake of evading defenses and observation. This may be done by placing an executable in a commonly trusted directory (ex: under System32) or giving it the name of a legitimate, trusted program (ex: svchost.exe). In containerized environments, this may also be done by creating a resource in a namespace that matches the naming convention of a container pod or cluster. Alternatively, a file or container image name given may be a close approximation to legitimate programs/images or something innocuous.

Adversaries may also use the same icon of the file they are trying to mimic.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Code Signing - Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.</p>
                    <p>Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</p>
                    <p>Restrict File and Directory Permissions - Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Network Share Discovery</button>
              <div class="content">
                <p>Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement. Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network. 

File sharing over a Windows network occurs over the SMB protocol.   [<a href="https://attack.mitre.org/software/S0039">Net</a>] can be used to query a remote system for available shared drives using the <code>net view \\\\remotesystem</code> command. It can also be used to query shared drives on the local system using <code>net share</code>. For macOS, the <code>sharing -l</code> command lists all shared points used for smb services.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Use Alternate Authentication Material: Pass the Hash</button>
              <div class="content">
                <p>Adversaries may “pass the hash” using stolen password hashes to move laterally within an environment, bypassing normal system access controls. Pass the hash (PtH) is a method of authenticating as a user without having access to the user's cleartext password. This method bypasses standard authentication steps that require a cleartext password, moving directly into the portion of the authentication that uses the password hash.

When performing PtH, valid password hashes for the account being used are captured using a [<a href="https://attack.mitre.org/tactics/TA0006">Credential Access</a>] technique. Captured hashes are used with PtH to authenticate as that user. Once authenticated, PtH may be used to perform actions on local or remote systems.

Adversaries may also use stolen password hashes to "overpass the hash." Similar to PtH, this involves using a password hash to authenticate as a user but also uses the password hash to create a valid Kerberos ticket. This ticket can then be used to perform [<a href="https://attack.mitre.org/techniques/T1550/003">Pass the Ticket</a>] attacks.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p>
                    <p>Update Software - Perform regular software updates to mitigate exploitation risk.</p>
                    <p>User Account Control - Configure Windows User Account Control to mitigate risk of adversaries obtaining elevated process access.</p>
                    <p>User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Process Discovery</button>
              <div class="content">
                <p>Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software/applications running on systems within the network. Adversaries may use the information from [<a href="https://attack.mitre.org/techniques/T1057">Process Discovery</a>] during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

In Windows environments, adversaries could obtain details on running processes using the [<a href="https://attack.mitre.org/software/S0057">Tasklist</a>] utility via [<a href="https://attack.mitre.org/software/S0106">cmd</a>] or <code>Get-Process</code> via [<a href="https://attack.mitre.org/techniques/T1059/001">PowerShell</a>]. Information about processes can also be extracted from the output of [<a href="https://attack.mitre.org/techniques/T1106">Native API</a>] calls such as <code>CreateToolhelp32Snapshot</code>. In Mac and Linux, this is accomplished with the <code>ps</code> command. Adversaries may also opt to enumerate processes via /proc.</p>
              </div>
            <button id="button2" class="collapsible">Remote Services: Remote Desktop Protocol</button>
              <div class="content">
                <p>Adversaries may use [<a href="https://attack.mitre.org/techniques/T1078">Valid Accounts</a>] to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.

Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). 

Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the [<a href="https://attack.mitre.org/techniques/T1546/008">Accessibility Features</a>] technique for Persistence.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</p>
                    <p>Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</p>
                    <p>Limit Access to Resource Over Network - Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.</p>
                    <p>Multi-factor Authentication - Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.</p>
                    <p>Network Segmentation - Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.</p>
                    <p>Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</p>
                    <p>Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</p>
                    <p>User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Email Collection: Remote Email Collection</button>
              <div class="content">
                <p>Adversaries may target an Exchange server, Office 365, or Google Workspace to collect sensitive information. Adversaries may leverage a user's credentials and interact directly with the Exchange server to acquire information from within a network. Adversaries may also access externally facing Exchange services, Office 365, or Google Workspace to access email using credentials or access tokens. Tools such as [<a href="https://attack.mitre.org/software/S0413">MailSniper</a>] can be used to automate searches for specific keywords.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Encrypt Sensitive Information - Protect sensitive information with strong encryption.</p>
                    <p>Multi-factor Authentication - Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Phishing: Spearphishing Attachment</button>
              <div class="content">
                <p>Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon [<a href="https://attack.mitre.org/techniques/T1204">User Execution</a>] to gain execution. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.

There are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one. </p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</p>
                    <p>Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</p>
                    <p>Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</p>
                    <p>Software Configuration - Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.</p>
                    <p>User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Phishing: Spearphishing Link</button>
              <div class="content">
                <p>Adversaries may send spearphishing emails with a malicious link in an attempt to gain access to victim systems. Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.

All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging [<a href="https://attack.mitre.org/techniques/T1204">User Execution</a>]. The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place. Adversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly or verify the receipt of an email (i.e. web bugs/web beacons). Links may also direct users to malicious applications  designed to [<a href="https://attack.mitre.org/techniques/T1528">Steal Application Access Token</a>]s, like OAuth tokens, in order to gain access to protected applications and information.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</p>
                    <p>Software Configuration - Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.</p>
                    <p>User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">System Network Configuration Discovery</button>
              <div class="content">
                <p>Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include [<a href="https://attack.mitre.org/software/S0099">Arp</a>], [<a href="https://attack.mitre.org/software/S0100">ipconfig</a>]/[<a href="https://attack.mitre.org/software/S0101">ifconfig</a>], [<a href="https://attack.mitre.org/software/S0102">nbtstat</a>], and [<a href="https://attack.mitre.org/software/S0103">route</a>].

Adversaries may use the information from [<a href="https://attack.mitre.org/techniques/T1016">System Network Configuration Discovery</a>] during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next. </p>
              </div>
            <button id="button2" class="collapsible">System Network Connections Discovery</button>
              <div class="content">
                <p>Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. 

An adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate.

Utilities and commands that acquire this information include [<a href="https://attack.mitre.org/software/S0104">netstat</a>], "net use," and "net session" with [<a href="https://attack.mitre.org/software/S0039">Net</a>]. In Mac and Linux, [<a href="https://attack.mitre.org/software/S0104">netstat</a>] and <code>lsof</code> can be used to list current connections. <code>who -a</code> and <code>w</code> can be used to show which users are currently logged in, similar to "net session".</p>
              </div>
            <button id="button2" class="collapsible">System Service Discovery</button>
              <div class="content">
                <p>Adversaries may try to get information about registered services. Commands that may obtain information about services using operating system utilities are "sc," "tasklist /svc" using [<a href="https://attack.mitre.org/software/S0057">Tasklist</a>], and "net start" using [<a href="https://attack.mitre.org/software/S0039">Net</a>], but adversaries may also use other tools as well. Adversaries may use the information from [<a href="https://attack.mitre.org/techniques/T1007">System Service Discovery</a>] during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.</p>
              </div>
            <button id="button2" class="collapsible">Obtain Capabilities: Tool</button>
              <div class="content">
                <p>Adversaries may buy, steal, or download software tools that can be used during targeting. Tools can be open or closed source, free or commercial. A tool can be used for malicious purposes by an adversary, but (unlike malware) were not intended to be used for those purposes (ex: [<a href="https://attack.mitre.org/software/S0029">PsExec</a>]). Tool acquisition can involve the procurement of commercial software licenses, including for red teaming tools such as [<a href="https://attack.mitre.org/software/S0154">Cobalt Strike</a>]. Commercial software may be obtained through purchase, stealing licenses (or licensed copies of the software), or cracking trial versions.

Adversaries may obtain tools to support their operations, including to support execution of post-compromise behaviors. In addition to freely downloading or purchasing software, adversaries may steal software and/or software licenses from third-party entities (including other adversaries).</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</p>
                  </div>
              </div>
            <button id="button2" class="collapsible">Command and Scripting Interpreter: Windows Command Shell</button>
              <div class="content">
                <p>Adversaries may abuse the Windows command shell for execution. The Windows command shell ([<a href="https://attack.mitre.org/software/S0106">cmd</a>]) is the primary command prompt on Windows systems. The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands. The command prompt can be invoked remotely via [<a href="https://attack.mitre.org/techniques/T1021">Remote Services</a>] such as [<a href="https://attack.mitre.org/techniques/T1021/004">SSH</a>].

Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops. Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple systems.

Adversaries may leverage [<a href="https://attack.mitre.org/software/S0106">cmd</a>] to execute various commands and payloads. Common uses include [<a href="https://attack.mitre.org/software/S0106">cmd</a>] to execute a single command, or abusing [<a href="https://attack.mitre.org/software/S0106">cmd</a>] interactively with input and output forwarded over a command and control channel.</p>
                <button id="button3" class="collapsible">Mitigations</button>
                  <div class="content">
                    <p>Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</p>
                  </div>
              </div>
          </div>
        </div>
      </div>
      <div class="footer">
        <ul>
          <li><a href="https://github.com/redbeardmeric/APTAnalyzer"><img src="./images/Github.png"></a></li>
          <li><a href="https://attack.mitre.org/"><img src="./images/Attck.png"></a></li>
        </ul>
      </div>
    </div>
    <script>
      var coll = document.getElementsByClassName("collapsible");
      var i;
      for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function(){
          this.classList.toggle("active");
          var content = this.nextElementSibling;
          if (content.style.maxHeight){
            content.style.maxHeight = null;
          } else {
            content.style.maxHeight = 1000000 + "px";
          } 
        });
      }
    </script>
  </body>
</html>